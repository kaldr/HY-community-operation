<!DOCTYPE html>
<html lang="zh" ng-app="sender" ng-cloak>
  <head>
    <title>短信群发</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" type="text/css" href="../../css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../../css/message.css">
  </head>
  <body>
    <div ng-controller="SenderController as vm" ng-init="vm.setClub('Hanlin')" class="container">
      <div id="header">
        <h1>{{vm.club.clubName}}短信群发<span ng-show="vm.memberCount" class="badge">{{vm.memberCount}}个会员，共{{vm.sendList.length}}可发送短信</span></h1>
      </div>
      <ul ng-init="vm.currentTab=1" class="nav nav-tabs">
        <li ng-class="{'active':vm.currentTab==1}"><a ng-click="vm.currentTab=1">新短信</a></li>
        <li ng-class="{'active':vm.currentTab==2}"><a ng-click="vm.currentTab=2">发送记录</a></li>
        <li ng-class="{'active':vm.currentTab==3}" ng-show="vm.cantSendList.length"><a ng-click="vm.currentTab=3">非手机号码<span class="badge">{{vm.cantSendList.length}}个</span></a></li>
      </ul>
      <div id="newMessage" ng-show="vm.currentTab==1">
        <div ng-show="!vm.content||vm.content.length/64&lt;=3" class="alert alert-warning">
          <p class="intro">注意：每一条短信都会<strong>产生费用！</strong>请谨慎操作！</p>
        </div>
        <div ng-show="vm.content.length/64&gt;3" class="alert alert-danger">
          <p class="intro">内容过长。一条信息，不可超过3条短信。</p>
        </div>
        <form>
          <div class="form-group">
            <label class="textareaTip">编辑短信内容 </label>
            <p ng-show="vm.content.length&gt;0" class="badge">{{vm.content.length}}个字，共分{{vm.content.length|toMessageNumber}}条短信发送</p>
          </div>
          <div class="form-group">
            <textarea rows="5" ng-model="vm.content" class="form-control"></textarea>
          </div>
          <button ng-click="vm.sendMessage()" ng-disabled="!vm.content.length||vm.content.length/64&gt;3||vm.sending" class="btn btn-primary">发送</button>
        </form>
      </div>
      <div id="history" ng-show="vm.currentTab==2">
        <div ng-show="vm.sentHistory.length==0" class="alert alert-warning">
          <p class="intro">暂时没有发送记录</p>
        </div>
        <table ng-hide="vm.sentHistory.length==0" class="table">
          <thead>
            <tr>
              <th>发送时间</th>
              <th>发送内容</th>
              <th>发送人数</th>
              <th>状态</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="historyitem in vm.sentHistory|orderBy:&quot;-time&quot;" ng-class="{'sending':historyitem.sending}">
              <th>{{historyitem.time*1000|date:"yyyy-MM-dd HH:mm:ss"}}</th>
              <td>{{historyitem.content}}</td>
              <td>{{historyitem.membersCount}}</td>
              <td>{{historyitem.sending?'发送中':'已发送'}}</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div id="errorCellphone" ng-show="vm.currentTab==3">
        <table class="table">
          <thead>
            <tr>
              <th>编号</th>
              <th>手机</th>
              <th>会员</th>
              <th>地址</th>
              <th>职务</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="member in vm.cantSendList">
              <th>{{$index+1}}</th>
              <th>{{member.Cellphone}}</th>
              <td>{{member.HName}}</td>
              <td>{{member.AddressDetail}}</td>
              <td>{{member.YDuties}}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <script src="../../js/underscore-min.js">		</script>
    <script src="../../js/angular.min.js"></script>
    <script src="../../js/jquery.min.js"></script>
    <script src="../../js/sender.js"></script>
  </body>
</html>